(function($){$.fn.evoGenmaps=function(opt){var defaults={delay:0,fnt:5,cal:'',SC:'',map_canvas_id:'',location_type:'',address:'',styles:'',zoomlevel:'',mapformat:'',scroll:!1,iconURL:'',trigger_point:'',};var options=$.extend({},defaults,opt);var geocoder;var code={};obj=this;code.obj=this;mapBox=$('#'+options.map_canvas_id);code={init:function(){if(!(mapBox.is(':visible')))return;if(mapBox.find('.gm-style').length>0)return;mapBox.html(evo_general_params.html.preload_gmap);if(obj.closest('.ajde_evcal_calendar').length>0){options.cal=obj.closest('.ajde_evcal_calendar')}
code.process_SC();if(options.fnt==5){if(options.delay==0){code.draw_map()}else{setTimeout(code.draw_map,options.delay,this)}}
if(options.fnt==1){code.load_gmap()}
if(options.fnt==2){if(options.delay==0){code.load_gmap()}else{setTimeout(code.load_gmap,options.delay,this)}}
if(options.fnt==3){code.load_gmap()}
if(options.fnt==4){if(this.attr('data-gmtrig')=='1'&&this.attr('data-gmap_status')!='null'){code.load_gmap()}}},process_unique_map_id:function(){var map_element=obj.closest('.eventon_list_event').find('.evo_metarow_gmap');if(map_element===undefined)return!1;var old_map_canvas_id=map_element.attr('id');if(old_map_canvas_id===undefined)return!1;maximum=99;minimum=10;var randomnumber=Math.floor(Math.random()*(maximum-minimum+1))+minimum;map_canvas_id=old_map_canvas_id+'_'+randomnumber;map_element.attr('id',map_canvas_id).addClass('test');options.map_canvas_id=map_canvas_id;return map_canvas_id},process_SC:function(){CAL=options.cal;if(options.SC!=='')return;if(CAL=='')return!1;options.SC=CAL.evo_shortcode_data()},load_gmap:function(){SC=options.SC;var ev_location=obj.find('.event_location_attrs');var location_type=ev_location.attr('data-location_type');if(location_type=='address'){options.address=ev_location.attr('data-location_address');options.location_type='add'}else{options.address=ev_location.attr('data-latlng');options.location_type='latlng'}
if(SC!==undefined&&SC!=''&&'mapiconurl' in SC)options.iconURL=SC.mapiconurl;if(options.address===undefined||options.address==''){console.log('Location address missing in options.address');return!1}
map_canvas_id=code.process_unique_map_id();if(!map_canvas_id||$('#'+map_canvas_id).length==0){console.log('Map element with id missing in page');return!1}
var zoom=SC.mapzoom;options.zoomlevel=(typeof zoom!=='undefined'&&zoom!==!1)?parseInt(zoom):12;options.scroll=SC.mapscroll;options.mapformat=SC.mapformat;code.draw_map()},draw_map:function(){if(!options.map_canvas_id||$('body').find('#'+options.map_canvas_id).length==0){console.log('Map element with id missing in page');return!1}
if(typeof gmapstyles!=='undefined'&&gmapstyles!='default'){options.styles=JSON.parse(gmapstyles)}
geocoder=new google.maps.Geocoder();var latlng=0;if(options.scroll=='false'||options.scroll==!1){var myOptions={mapTypeId:options.mapformat,zoom:options.zoomlevel,scrollwheel:!1,styles:options.styles,zoomControl:!0,draggable:!1}}else{var myOptions={mapTypeId:options.mapformat,zoom:options.zoomlevel,styles:options.styles,zoomControl:!0,scrollwheel:!0,}}
var map_canvas=document.getElementById(options.map_canvas_id);map=new google.maps.Map(map_canvas,myOptions);if(options.location_type=='latlng'&&options.address!==undefined){var latlngStr=options.address.split(",",2);var lat=parseFloat(latlngStr[0]);var lng=parseFloat(latlngStr[1]);var latlng=new google.maps.LatLng(lat,lng);geocoder.geocode({'latLng':latlng},function(results,status){if(status==google.maps.GeocoderStatus.OK){var marker=new google.maps.Marker({map:map,position:latlng,icon:options.iconURL});map.setCenter(marker.getPosition());console.log('f')}else{document.getElementById(options.map_canvas_id).style.display='none'}})}else if(options.address==''){}else{geocoder.geocode({'address':options.address},function(results,status){if(status==google.maps.GeocoderStatus.OK){console.log('map '+results[0].geometry.location);map.setCenter(results[0].geometry.location);var marker=new google.maps.Marker({map:map,position:results[0].geometry.location,icon:options.iconURL})}else{document.getElementById(options.map_canvas_id).style.display='none'}})}
$('#'+options.map_canvas_id).addClass('mDrawn')}}
code.init()};$.fn.evo_load_gmap=function(opt){var defs={'map_canvas_id':'','delay':0,trigger_point:'',};var OO=$.extend({},defs,opt);EL=this;EL_id=EL.attr('id');if(('map_canvas_id' in OO)&&OO.map_canvas_id!='')EL_id=OO.map_canvas_id;var location_type='add';var location_type=EL.data('location_type');if(location_type=='add'){var address=EL.data('address')}else{var address=EL.data('latlng');var location_type='latlng'}
scrollwheel=EL.data('scroll')=='yes'?true:!1;var elms=document.querySelectorAll("[id='"+EL_id+"']");if(elms.length>1){maximum=99;minimum=10;var randomnumber=Math.floor(Math.random()*(maximum-minimum+1))+minimum;EL_id=EL_id+'_'+randomnumber;EL.attr('id',EL_id)}
__delay=0;if(EL.data('delay'))__delay=EL.data('delay');if(OO.delay!=0)__delay=OO.delay;EL.evoGenmaps({map_canvas_id:EL.attr('id'),fnt:5,location_type:location_type,address:address,zoomlevel:parseInt(EL.data('zoom')),mapformat:EL.data('mty'),scroll:scrollwheel,iconURL:(EL.data('mapicon')!==undefined?EL.data('mapicon'):''),delay:__delay,trigger_point:OO.trigger_point,})}}(jQuery))
;